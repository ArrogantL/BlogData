# L07数据交换-报文交换、分组交换

## 报文交换

其实非常简单，就是指把信息打包，一次性发送。打包的信息叫做**报文**。

**报文交换中存储转发顺序：谁先完整发过来谁先被发送！而不是谁的第一个bit先到打谁先走。**

## 分组交换

报文交换的改进版，把报文拆成较小的数据包，分开传送，再重新组装。

和报文交换区别：

- 需要拆分重组
- 数据包要额外包头
- 可并行传送

### 统计多路复用

分组交换使用统计多路复用。

统计多路复用即路由器将接收到的数据包加入缓存队列，逐一发送，那么多个主机发送的数据包，路由器并不区分，只是接受并发送，谁发的快，路由器就更可能下一个发送其数据包，即表现统计倾向。

不像电路分组的资源独占式多路复用，统计多路复用是一种按需共享的动态复用技术。

##　报文交换vs分组交换

###　存储转发

报文交换与分组交换均采用存储-转发交换方式

- 报文交换以完整报文进行“存储-转发”
  - 需要更大的路由器缓存
  - 串行发送
  - 不需要额外时间拆分合并
  - 无文件头
- 分组交换以较小的分组进行“存储-转发”
  - 路由器缓存要求低
  - 并行发送
  - 需要额外时间来拆分合并
  - 附加额外文件头

### 报文交付时间差异

报文: M bits

链路带宽 : R bps

分组长度（大小） : L bits

跳步数: h

路由器数: n=h-1

T<sub>分组交换</sub>=M/R+(h-1)L/R=M/R+nL/R

T<sub>报文交换</sub>=hM/R

由于分组交换的并行发送机制，使得多路由器的整体带宽利用率被提高。

## 分组交换vs电路交换

两者的区分主要在于分组交换的存储转发机制以及拆分合并传输。

- 由于**分组转发**是统计多路复用，因此相比电路交换的独占多路复用能够更灵活的分配物理链路资源，**允许更多用户同时使用网络。**
- 分组转发适用于突发数据传输网络
- **分组转发**，当路由器接受过多内容导致缓存填满时会丢弃后续数据包，产生**数据丢失**。队列等待也会产生**传输延迟**。需要协议处理可靠数据传输和拥塞控制。
- 电路交换虽然无法灵活分配资源，但是能够提供稳定低延迟的连接

> **Q:**分组交换是现代计算机网络重要的理论基础之一，也是目前在计算机网络中广泛采用的数据交换技术，存储-转发则是分组交换的基本工作方式。请大家讨论一下，分组交换是否可以采取其他工作方式？有什么样的优缺点？
>
> **A:**
>
> **直通转发（Cut-through Switching）**
>
> 交换机在接收整个帧之前读取目标地址，然后在整个帧到达之前转发帧。此模式减少了传输
>
> 的延迟，但缺少检查，且不支持不同输入输出速率的端口间的数据转发。 其有两种形式，快
>
> 速转发和无碎片转发。
>
> **快速转发（Fast-forward switching）**
>
> 快速转发通过在接收目标地址（帧的前6个字节）后立即转发帧来提供最低级别的延迟。由于
>
> 其不会检查错误，因此可能会出现转发坏帧的情况。虽然这种情况很少发生，并且目标网络
>
> 适配器在收到时会丢弃坏帧，但在具有高冲突率的网络中，这会对可用带宽产生负面影响。
>
> **无碎片转发（Fragment-Free Switching）**
>
> 无碎片转发是直通转发的一种改进形式。在进行转发之前，交换机读取以太网帧的至少64个
>
> 字节，避免转发小于64字节的以太网帧，以此过滤掉冲突片段。但如果频繁发送数据量很小
>
> 的报文，会导致带宽的利用效率低下。

